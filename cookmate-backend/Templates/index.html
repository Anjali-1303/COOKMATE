<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>CookMate - AI Voice Cooking Assistant</title>
  <!-- CSS path fixed for Flask static -->
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
  <!-- Login/Register Modal -->
  <div id="authModal" class="modal" style="display:none">
    <div class="modal-content">
      <span class="closeBtn" onclick="document.getElementById('authModal').style.display='none'">&times;</span>
      <h2 id="authTitle">Login</h2>
      <form id="authForm">
        <input type="email" id="authEmail" placeholder="Email" required />
        <input type="password" id="authPassword" placeholder="Password" required />
        <button type="submit" class="btn" id="authSubmit">Login</button>
      </form>
      <div style="margin-top:10px;text-align:center">
        <small id="toggleAuth" style="cursor:pointer;text-decoration:underline">Don't have an account? Register</small>
      </div>
      <hr style="margin:12px 0" />
      <button id="googleLogin" class="btn alt" style="width:100%">Login with Google</button>
    </div>
  </div>

  <div class="container">
    <!-- Header -->
    <header class="logo-bar">
      <div class="logo">
        <img src="{{ url_for('static', filename='images/cookmate logo.png') }}" alt="logo" onerror="this.style.display='none'" />
        <div>
          <div style="font-size:18px">CookMate</div>
          <div style="font-size:12px;opacity:.9">AI Voice Cooking Assistant</div>
        </div>
      </div>
      <div style="display:flex;align-items:center;gap:12px">
        <nav class="nav">
          <a href="#" data-route="home" class="nav-link">Home</a>
          <a href="#" data-route="recipes" class="nav-link">Recipes</a>
          <a href="#" data-route="pantry" class="nav-link">My Pantry</a>
          <a href="#" data-route="subs" class="nav-link">Substitutions</a>
          <a href="#" data-route="admin" class="nav-link">Admin</a>
          <a href="#" data-route="profile" class="nav-link">Profile</a>
        </nav>
        <div class="search-voice">
          <input id="globalSearch" type="search" placeholder="Search recipes..." style="padding:8px;border-radius:8px;border:none;min-width:180px"/>
          <button id="voiceBtn" title="Voice search - Click to speak">🎙️</button>
        </div>
      </div>
    </header>

    <!-- Main -->
    <div class="main">
      <!-- Sidebar -->
      <aside class="sidebar">
        <div class="side-title">Explore</div>
        <div class="side-list">
          <button data-route="home" class="active">🏠 Home</button>
          <button data-route="recipes">🍽 Recipes</button>
          <button data-route="pantry">🥫 My Pantry</button>
          <button data-route="subs">🔄 Substitutions</button>
          <button data-route="feedback">💬 Feedback</button>
          <button data-route="admin">⚙️ Admin</button>
          <button data-route="profile">👤 Profile</button>
        </div>
        <hr style="margin:12px 0;border:none;border-top:1px solid #f1f5f9" />
        <div style="margin-top:8px">
          <div style="font-weight:700;color:var(--accent)">Quick Pantry</div>
          <div id="quickPantry" class="pantry-list" style="margin-top:10px">
            <small class="muted">No items yet</small>
          </div>
          <div style="margin-top:12px">
            <button class="btn" id="addRandom" onclick="alert('Add items from the Pantry page')">+ Add ingredient</button>
          </div>
        </div>
      </aside>

      <!-- Content -->
      <main class="content">
        <!-- HOME -->
        <section id="view-home" class="view">
          <div class="card hero">
            <div class="hero-left">
              <div class="hero-title">CookMate – your AI voice chef</div>
              <div class="hero-sub">Get step-by-step voice-guided recipes, pantry-driven suggestions, and smart ingredient substitutions.</div>
              <div style="margin-top:14px" class="row">
                <button class="btn" data-route="recipes">Find Recipes</button>
                <button class="btn alt" data-route="pantry">Open Pantry</button>
              </div>
              <small style="margin-top:8px;display:block" class="muted">💡 Tip: Click the 🎙️ button to search recipes with your voice!</small>
            </div>
            <div class="hero-right">
              <div style="text-align:center">
                <div style="font-weight:700;margin-bottom:6px">Voice Ready</div>
                <div class="voice-dot" id="voiceAnim" title="Voice visualizer"></div>
                <small class="muted" style="margin-top:8px;display:block">Say "show me recipes"</small>
              </div>
            </div>
          </div>
          <div class="card">
            <div style="display:flex;justify-content:space-between;align-items:center">
              <div style="font-weight:800">Featured Recipes</div>
              <small class="muted">From your database</small>
            </div>
            <div style="height:12px"></div>
            <div id="featuredGrid" class="grid">
              <div style="padding:20px;text-align:center;color:#9ca3af">Loading recipes...</div>
            </div>
          </div>
          <div class="card">
            <div style="display:flex;justify-content:space-between;align-items:center">
              <div style="font-weight:800">How CookMate helps</div>
            </div>
            <div style="display:flex;gap:12px;margin-top:12px;flex-wrap:wrap">
              <div style="flex:1;min-width:220px" class="card">
                <div style="font-weight:700;color:var(--accent)">🎤 Voice-guided steps</div>
                <small class="muted">Hands-free cooking with adjustable speech speed.</small>
              </div>
              <div style="flex:1;min-width:220px" class="card">
                <div style="font-weight:700;color:var(--accent)">🔄 Smart substitutions</div>
                <small class="muted">AI suggests alternatives when you miss ingredients.</small>
              </div>
              <div style="flex:1;min-width:220px" class="card">
                <div style="font-weight:700;color:var(--accent)">🥫 Pantry-driven suggestions</div>
                <small class="muted">See recipes you can cook with what's in your kitchen.</small>
              </div>
            </div>
          </div>
        </section>

        <!-- RECIPES -->
        <section id="view-recipes" class="view" style="display:none">
          <div class="card">
            <div style="display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:10px">
              <div style="font-weight:800">Search Recipes</div>
              <div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap">
                <input id="searchQuery" type="search" placeholder="Search..." style="width:150px;padding:6px"/>
                <select id="filterCuisine" style="padding:6px">
                  <option value="">All Cuisines</option>
                  <option>Indian</option>
                  <option>Italian</option>
                  <option>Asian</option>
                </select>
                <select id="filterDifficulty" style="padding:6px">
                  <option value="">Any difficulty</option>
                  <option>Easy</option>
                  <option>Medium</option>
                  <option>Hard</option>
                </select>
                <button class="btn" id="refreshRecipes" onclick="location.reload()">Refresh</button>
              </div>
            </div>
            <div style="height:12px"></div>
            <div id="recipesGrid" class="grid">
              <div style="padding:20px;text-align:center;color:#9ca3af">Loading recipes...</div>
            </div>
          </div>
        </section>

        <!-- RECIPE DETAIL -->
        <section id="view-recipe-detail" class="view" style="display:none">
          <div class="card" id="recipeHeader">
            <div style="padding:20px;text-align:center;color:#9ca3af">Select a recipe to view details</div>
          </div>
          <div class="recipe-detail" style="margin-top:12px">
            <div>
              <div class="card">
                <h3>Ingredients</h3>
                <div id="ingredientsList"></div>
                <div style="margin-top:8px">
                  <input type="text" id="addPantryInput" placeholder="Add ingredient to pantry..." />
                  <div style="height:8px"></div>
                  <button class="btn" id="addToPantryBtn" onclick="alert('Login to add to pantry')">Add to Pantry</button>
                </div>
              </div>
              <div class="card" style="margin-top:12px">
                <h3>Steps</h3>
                <div id="stepsList"></div>
                <div style="margin-top:8px" class="row">
                  <button class="btn" id="startVoicePlay">▶️ Start voice playback</button>
                  <button class="btn alt" id="stopVoicePlay">⏹ Stop</button>
                </div>
                <small class="muted" style="margin-top:8px;display:block">Voice will read each step with pauses. Adjust speed in Profile.</small>
              </div>
            </div>
            <aside>
              <div class="card">
                <h4>Smart substitutions</h4>
                <div id="subsList" class="sub-list">
                  <small class="muted">Click "Find Substitute" for suggestions</small>
                </div>
              </div>
              <div class="card" style="margin-top:12px">
                <h4>Quick actions</h4>
                <div style="display:flex;flex-direction:column;gap:8px">
                  <button class="btn" id="favBtn">⭐ Add to Favorites</button>
                  <button class="btn alt" id="feedbackBtn" data-route="feedback">💬 Give Feedback</button>
                </div>
              </div>
            </aside>
          </div>
        </section>

        <!-- PANTRY -->
        <section id="view-pantry" class="view" style="display:none">
          <div class="card">
            <div style="display:flex;justify-content:space-between;align-items:center">
              <div style="font-weight:800">My Pantry</div>
              <div class="muted">Expires shown in <strong>days</strong></div>
            </div>
            <div style="margin-top:12px" class="row">
              <input id="pantryInput" type="text" placeholder="e.g., tomato" />
              <input id="pantryExpiry" type="number" placeholder="Expiry days" style="width:120px" value="7" />
              <button class="btn" id="addPantryBtn">Add</button>
            </div>
            <div style="margin-top:12px" id="pantryGrid" class="pantry-list">
              <small class="muted">Login to manage your pantry</small>
            </div>
          </div>
        </section>

        <!-- SUBSTITUTIONS -->
        <section id="view-subs" class="view" style="display:none">
          <div class="card">
            <h3>Smart Substitution Engine</h3>
            <small class="muted">Enter an ingredient to see suggested substitutes.</small>
            <div style="height:12px"></div>
            <div style="display:flex;gap:12px;flex-wrap:wrap">
              <input id="subQuery" placeholder="Enter ingredient (e.g., buttermilk)" style="flex:1;min-width:200px" />
              <button class="btn" id="findSubs">Find substitutions</button>
            </div>
            <div style="margin-top:12px" id="subResults" class="sub-list">
              <small class="muted">Try: buttermilk, butter, egg, milk, tomato</small>
            </div>
          </div>
        </section>

        <!-- FEEDBACK -->
        <section id="view-feedback" class="view" style="display:none">
          <div class="card">
            <h3>Cooking Feedback</h3>
            <p class="muted">Tell CookMate how your recipe turned out.</p>
            <div style="margin-top:8px">
              <label>Overall Rating</label>
              <div id="fbStars" class="row" style="gap:6px">
                <span style="font-size:24px;cursor:pointer">⭐⭐⭐⭐⭐</span>
              </div>
              <div style="display:flex;gap:12px;margin-top:12px;flex-wrap:wrap">
                <div style="flex:1;min-width:150px">
                  <label>Spice level</label>
                  <input id="fbSpice" type="range" min="1" max="5" value="3"/>
                  <small class="muted">1 = Mild, 5 = Very Spicy</small>
                </div>
                <div style="flex:1;min-width:150px">
                  <label>Salt level</label>
                  <input id="fbSalt" type="range" min="1" max="5" value="3"/>
                  <small class="muted">1 = Less, 5 = More</small>
                </div>
                <div style="flex:1;min-width:150px">
                  <label>Sweetness</label>
                  <input id="fbSweet" type="range" min="1" max="5" value="3"/>
                  <small class="muted">1 = Less, 5 = More</small>
                </div>
              </div>
              <div style="margin-top:12px">
                <label>Overall taste</label>
                <textarea id="fbTaste" rows="3" placeholder="How did it taste?"></textarea>
                <label style="margin-top:10px">Improvements</label>
                <textarea id="fbImprove" rows="2" placeholder="What would you change?"></textarea>
                <div style="height:10px"></div>
                <button class="btn" id="submitFb">Submit feedback</button>
              </div>
            </div>
          </div>
        </section>

        <!-- ADMIN -->
        <section id="view-admin" class="view" style="display:none">
          <div class="card">
            <h3>Admin Dashboard</h3>
            <div style="height:12px"></div>
            <div class="admin-grid">
              <div class="stat">
                <div style="font-size:20px;font-weight:800" id="statRecipes">0</div>
                <small class="muted">Recipes</small>
              </div>
              <div class="stat">
                <div style="font-size:20px;font-weight:800" id="statUsers">2</div>
                <small class="muted">Users</small>
              </div>
              <div class="stat">
                <div style="font-size:20px;font-weight:800" id="statFeedback">0</div>
                <small class="muted">Feedbacks</small>
              </div>
            </div>
            <div style="margin-top:12px">
              <h4>Recent Activity</h4>
              <div id="adminActivity" style="max-height:160px;overflow:auto">
                <small class="muted">Activity logs will appear here</small>
              </div>
            </div>
          </div>
        </section>

        <!-- PROFILE -->
        <section id="view-profile" class="view" style="display:none">
          <div class="card">
            <h3>Your Profile</h3>
            <div style="display:flex;gap:12px;align-items:center;margin-top:10px">
              <img src="https://img.icons8.com/ios-filled/100/user-male-circle.png" width="72" alt="avatar" />
              <div>
                <div style="font-weight:800">Demo User</div>
                <small class="muted">demo@cookmate.local</small>
              </div>
            </div>
            <div style="margin-top:12px">
              <label>Diet preferences</label>
              <select id="prefDiet">
                <option value="">None</option>
                <option value="veg">Vegetarian</option>
                <option value="vegan">Vegan</option>
                <option value="glutenfree">Gluten-free</option>
              </select>
              <div style="height:10px"></div>
              <label>Voice rate (for playback) - Current: <span id="voiceRateDisplay">0.95</span></label>
              <input id="prefVoiceRate" type="range" min="0.6" max="1.6" step="0.1" value="0.95" oninput="document.getElementById('voiceRateDisplay').innerText = this.value"/>
              <small class="muted" style="display:block;margin-top:4px">0.6 = Slow, 1.0 = Normal, 1.6 = Fast</small>
              <div style="height:10px"></div>
              <button class="btn" id="savePrefs">Save Preferences</button>
            </div>
          </div>
        </section>
      </main>
    </div>
    <footer>CookMate @2025 - AI Voice Cooking Assistant</footer>
  </div>

  <!-- JS path fixed for Flask static -->
  <script src="{{ url_for('static', filename='app.js') }}"></script>
</body>
</html>
